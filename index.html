<!DOCTYPE html>
<html lang="es" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHINES - Tu Plataforma de Anime y Manga</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- VARIABLES Y ESTILOS GLOBALES --- */
        :root {
            --primary: #ff6b1a; --primary-dark: #e55a0f; 
            --bg: #0a0a0a; --bg-secondary: #141414; --bg-card: #1a1a1a;
            --text: #ffffff; --text-secondary: #a0a0a0; --border: #2a2a2a;
            --radius: 12px; --transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94 );
            --shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        [data-theme="light"] {
            --bg: #f5f5f5; --bg-secondary: #ffffff; --bg-card: #ffffff;
            --text: #1a1a1a; --text-secondary: #666666; --border: #e0e0e0;
        }
        
        [data-theme="girl"] {
            --primary: #ff69b4; --primary-dark: #e0559f;
            --bg: #fff0f5; --bg-secondary: #ffe4e1; --bg-card: #ffdab9;
            --text: #4b0082; --text-secondary: #9370db; --border: #ffc0cb;
        }
        
        [data-theme="boy"] {
            --primary: #1e90ff; --primary-dark: #0d7ae6;
            --bg: #0f1a2a; --bg-secondary: #1a2d4a; --bg-card: #243b5a;
            --text: #ffffff; --text-secondary: #add8e6; --border: #00bfff;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', system-ui, sans-serif; 
            background: var(--bg); color: var(--text); 
            min-height: 100vh; line-height: 1.6;
            transition: background 0.3s, color 0.3s;
        }
        
        /* --- HEADER Y NAVEGACIÓN --- */
        header { 
            position: sticky; top: 0;
            background: rgba(var(--bg-rgb, 10, 10, 10), 0.85); 
            backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border); z-index: 1000;
            padding: 0 5%;
        }
        
        .header-container { 
            display: flex; align-items: center; justify-content: space-between; 
            height: 70px; max-width: 1400px; margin: 0 auto;
        }
        
        .logo { 
            font-size: 1.8rem; font-weight: 800; 
            color: var(--primary); text-decoration: none;
        }
        
        .search-container { position: relative; width: 250px; }
        .search-input { 
            width: 100%; padding: 10px 40px 10px 15px; 
            background: var(--bg-card); border: 1px solid var(--border);
            border-radius: 20px; color: var(--text);
        }
        .search-btn { 
            position: absolute; right: 5px; top: 50%; transform: translateY(-50%); 
            background: transparent; border: none; cursor: pointer; color: var(--text-secondary);
        }
        
        .user-menu { display: flex; align-items: center; gap: 15px; }
        .theme-toggle, .user-avatar-btn { 
            width: 38px; height: 38px; border-radius: 50%; 
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; background: var(--bg-card); border: 1px solid var(--border);
        }
        
        /* --- BARRA LATERAL DE NAVEGACIÓN --- */
        .sidebar {
            position: fixed; top: 70px; left: 0;
            width: 240px; height: calc(100vh - 70px);
            background: var(--bg-secondary);
            border-right: 1px solid var(--border);
            padding: 20px;
            display: flex; flex-direction: column;
        }
        .nav-main { list-style: none; }
        .nav-main li { margin-bottom: 10px; }
        .nav-link {
            display: flex; align-items: center; gap: 15px;
            padding: 12px 15px; border-radius: 8px;
            color: var(--text-secondary); text-decoration: none;
            font-weight: 500; transition: var(--transition);
        }
        .nav-link:hover, .nav-link.active {
            background: var(--primary); color: white;
        }
        .nav-link i { width: 20px; text-align: center; }

        /* --- CONTENIDO PRINCIPAL --- */
        .main-content { 
            margin-left: 240px; 
            padding: 30px;
        }
        
        .section-title { font-size: 1.8rem; font-weight: 700; margin-bottom: 20px; }
        
        .content-grid { 
            display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); 
            gap: 20px; 
        }
        
        .content-card { 
            background: var(--bg-card); border-radius: var(--radius); 
            overflow: hidden; transition: var(--transition); 
            cursor: pointer;
        }
        .content-card:hover { 
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }
        
        .card-image { width: 100%; height: 250px; object-fit: cover; }
        .card-content { padding: 15px; }
        .card-title { 
            font-weight: 600; white-space: nowrap; 
            overflow: hidden; text-overflow: ellipsis;
        }

        /* --- PÁGINA DE DETALLE --- */
        .detail-header { display: flex; gap: 30px; margin-bottom: 30px; }
        .detail-poster { width: 250px; border-radius: var(--radius); flex-shrink: 0; }
        .detail-info h1 { font-size: 2.2rem; margin-bottom: 15px; }
        .detail-actions { display: flex; gap: 15px; margin: 20px 0; }
        .btn { 
            padding: 10px 20px; border-radius: 20px; font-weight: 600; 
            text-decoration: none; border: none; cursor: pointer;
        }
        .btn-primary { background: var(--primary); color: white; }
        .btn-secondary { background: var(--bg-card); color: var(--text); border: 1px solid var(--border); }

        .chapters-list .chapter-item {
            display: flex; justify-content: space-between; align-items: center;
            background: var(--bg-card); padding: 15px; border-radius: 8px;
            margin-bottom: 10px; border-left: 3px solid transparent;
            transition: var(--transition);
        }
        .chapters-list .chapter-item:hover {
            border-left-color: var(--primary);
            transform: translateX(5px);
        }
        .chapter-item-actions button {
            background: none; border: none; color: var(--text-secondary);
            cursor: pointer; font-size: 1.2rem; margin-left: 15px;
        }

        /* --- MODAL DE LOGIN --- */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.7);
            display: flex; justify-content: center; align-items: center;
            z-index: 2000;
        }
        .modal-content {
            background: var(--bg-secondary); padding: 2rem;
            border-radius: var(--radius); width: 90%; max-width: 400px;
        }

        /* --- RESPONSIVE --- */
        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); transition: transform 0.3s; }
            .main-content { margin-left: 0; }
            .header-container { justify-content: space-between; }
            /* Agrega una clase 'open' al sidebar con JS para mostrarlo */
            .sidebar.open { transform: translateX(0); }
        }
    </style>
</head>
<body>

    <div id="app">
        <header>
            <div class="header-container">
                <a href="#" class="logo">SHINES</a>
                <div class="search-container">
                    <input type="text" id="search-input" class="search-input" placeholder="Buscar series...">
                    <button class="search-btn"><i class="fas fa-search"></i></button>
                </div>
                <div class="user-menu">
                    <button class="theme-toggle" id="theme-toggle">
                        <i class="fas fa-sun"></i>
                    </button>
                    <button class="user-avatar-btn" id="user-avatar-btn">
                        <i class="fas fa-user"></i>
                    </button>
                </div>
            </div>
        </header>

        <nav class="sidebar" id="sidebar">
            <ul class="nav-main">
                <li><a href="#library" class="nav-link active" data-view="library"><i class="fas fa-swatchbook"></i> Biblioteca</a></li>
                <li><a href="#favorites" class="nav-link" data-view="favorites"><i class="fas fa-heart"></i> Favoritos</a></li>
                <li><a href="#history" class="nav-link" data-view="history"><i class="fas fa-history"></i> Historial</a></li>
                <li><a href="#news" class="nav-link" data-view="news"><i class="fas fa-newspaper"></i> Noticias</a></li>
            </ul>
        </nav>

        <main class="main-content" id="main-content">
            <!-- El contenido se renderizará aquí con JavaScript -->
        </main>
    </div>

    <!-- Firebase SDK (reemplaza con tu configuración) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', ( ) => {
        // --- CONFIGURACIÓN ---
        const FIREBASE_CONFIG = {
            apiKey: "TU_API_KEY", // <-- REEMPLAZA ESTO
            authDomain: "TU_AUTH_DOMAIN", // <-- REEMPLAZA ESTO
            projectId: "TU_PROJECT_ID", // <-- REEMPLAZA ESTO
            storageBucket: "TU_STORAGE_BUCKET",
            messagingSenderId: "TU_SENDER_ID",
            appId: "TU_APP_ID"
        };
        firebase.initializeApp(FIREBASE_CONFIG);
        const auth = firebase.auth();
        const db = firebase.firestore();

        const MAL_API_BASE = 'https://api.myanimelist.net/v2';
        const MAL_CLIENT_ID = '16d000832c5535ee1175473f869415c0'; // ID de cliente de ejemplo

        // --- ELEMENTOS DEL DOM ---
        const mainContent = document.getElementById('main-content' );
        const navLinks = document.querySelectorAll('.nav-link');
        const themeToggle = document.getElementById('theme-toggle');
        const userAvatarBtn = document.getElementById('user-avatar-btn');

        // --- ESTADO DE LA APLICACIÓN ---
        let currentUser = null;
        let currentView = 'library';

        // --- MANEJO DE AUTENTICACIÓN ---
        auth.onAuthStateChanged(user => {
            currentUser = user;
            updateUIForUser();
        });

        function updateUIForUser() {
            if (currentUser) {
                userAvatarBtn.innerHTML = `<i class="fas fa-sign-out-alt"></i>`;
                userAvatarBtn.onclick = () => auth.signOut();
            } else {
                userAvatarbtn.innerHTML = `<i class="fas fa-user"></i>`;
                userAvatarBtn.onclick = showLoginModal;
            }
        }

        function showLoginModal() {
            if (document.querySelector('.modal-overlay')) return;
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal-content">
                    <h2>Iniciar Sesión / Registrarse</h2>
                    <p>Usa tu cuenta de Google para continuar.</p>
                    <button id="google-login" class="btn btn-primary" style="width:100%; margin-top: 20px;">
                        <i class="fab fa-google"></i> Conectar con Google
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
            modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
            
            document.getElementById('google-login').onclick = () => {
                const provider = new firebase.auth.GoogleAuthProvider();
                auth.signInWithPopup(provider).then(() => modal.remove());
            };
        }

        // --- MANEJO DE TEMAS ---
        const themes = ['dark', 'light', 'girl', 'boy'];
        let currentThemeIndex = 0;
        themeToggle.onclick = () => {
            currentThemeIndex = (currentThemeIndex + 1) % themes.length;
            const theme = themes[currentThemeIndex];
            document.documentElement.setAttribute('data-theme', theme);
            themeToggle.innerHTML = theme === 'light' ? '<i class="fas fa-moon"></i>' : '<i class="fas fa-sun"></i>';
        };

        // --- NAVEGACIÓN ---
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                currentView = link.dataset.view;
                document.querySelector('.nav-link.active').classList.remove('active');
                link.classList.add('active');
                renderView();
            });
        });

        // --- RENDERIZADO DE VISTAS ---
        function renderView() {
            mainContent.innerHTML = ''; // Limpiar contenido
            switch (currentView) {
                case 'library':
                    renderLibrary();
                    break;
                case 'favorites':
                    renderPlaceholder("Favoritos", "Aquí aparecerán las series que marques como favoritas.");
                    break;
                case 'history':
                    renderPlaceholder("Historial", "Tu historial de lectura se guardará aquí.");
                    break;
                case 'news':
                    renderPlaceholder("Anuncios y Noticias", "Las últimas noticias y actualizaciones de SHINES.");
                    break;
            }
        }

        function renderPlaceholder(title, text) {
            mainContent.innerHTML = `
                <h1 class="section-title">${title}</h1>
                <p>${text}</p>
            `;
        }

        // --- LÓGICA DE LA BIBLIOTECA ---
        async function fetchManga(query = "manhwa") {
            try {
                const response = await fetch(`${MAL_API_BASE}/manga?q=${query}&limit=30&fields=id,title,main_picture`, {
                    headers: { 'X-MAL-CLIENT-ID': MAL_CLIENT_ID }
                });
                if (!response.ok) throw new Error('Fallo en la red');
                const data = await response.json();
                return data.data;
            } catch (error) {
                console.error("Error fetching manga:", error);
                mainContent.innerHTML = `<p>Error al cargar los datos. Inténtalo de nuevo más tarde.</p>`;
                return [];
            }
        }

        async function renderLibrary() {
            mainContent.innerHTML = `<h1 class="section-title">Biblioteca</h1><div class="content-grid" id="library-grid">Cargando...</div>`;
            const libraryGrid = document.getElementById('library-grid');
            const mangaList = await fetchManga();
            
            libraryGrid.innerHTML = mangaList.map(manga => `
                <div class="content-card" data-id="${manga.node.id}">
                    <img src="${manga.node.main_picture.large}" alt="${manga.node.title}" class="card-image">
                    <div class="card-content">
                        <p class="card-title">${manga.node.title}</p>
                    </div>
                </div>
            `).join('');

            document.querySelectorAll('.content-card').forEach(card => {
                card.addEventListener('click', () => renderDetailView(card.dataset.id));
            });
        }

        // --- VISTA DE DETALLE ---
        async function fetchMangaDetails(id) {
            const response = await fetch(`${MAL_API_BASE}/manga/${id}?fields=id,title,main_picture,synopsis,num_chapters`, {
                headers: { 'X-MAL-CLIENT-ID': MAL_CLIENT_ID }
            });
            return await response.json();
        }

        async function renderDetailView(id) {
            const details = await fetchMangaDetails(id);
            // Simulación de capítulos en Google Drive
            const chaptersHTML = Array.from({ length: details.num_chapters || 20 }, (_, i) => `
                <div class="chapter-item">
                    <p>Capítulo ${i + 1}</p>
                    <div class="chapter-item-actions">
                        <button title="Marcar como visto"><i class="far fa-eye"></i></button>
                        <a href="https://drive.google.com/drive/folders/TU_CARPETA_ID" target="_blank" title="Leer en Drive">
                           <i class="fas fa-book-open"></i>
                        </a>
                    </div>
                </div>
            ` ).join('');

            mainContent.innerHTML = `
                <div class="detail-view">
                    <div class="detail-header">
                        <img src="${details.main_picture.large}" alt="${details.title}" class="detail-poster">
                        <div class="detail-info">
                            <h1>${details.title}</h1>
                            <p>${details.synopsis.substring(0, 400)}...</p>
                            <div class="detail-actions">
                                <button class="btn btn-primary"><i class="fas fa-heart"></i> Añadir a Favoritos</button>
                                <button class="btn btn-secondary">Comentar</button>
                            </div>
                        </div>
                    </div>
                    <h2 class="section-title">Capítulos</h2>
                    <div class="chapters-list">${chaptersHTML}</div>
                </div>
            `;
        }

        // --- INICIALIZACIÓN ---
        renderView();
        updateUIForUser();
    });
    </script>
</body>
</html>
